<!DOCTYPE html>
<html lang="en" style="height:100%">
	<head>
		<title>Physiome Portal</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>			
			body {
				font-family: Monospace;
				background-color: #000;
				color: #fff;
				margin: 0px;
				overflow: hidden;
			}
			#info {
				color: #fff;
				position: absolute;
				top: 10px;
				width: 100%;
				text-align: center;
				z-index: 100;
				display:block;
			}
			#info a, .button { color: #f00; font-weight: bold; text-decoration: underline; cursor: pointer }			
		</style>
		<link rel="stylesheet" href="styles/my_styles.css">
		<link rel="stylesheet" href="styles/bootstrap.min.css">
		<link rel="stylesheet" href="styles/w3.css">
		<script>
	    	var dojoConfig = {
				async: true,
				// This code registers the correct location of the "demo" package
				// so we can load Dojo from the CDN whilst still being able to
				// load local modules
				packages: [{
					name: "js",
					location: location.pathname.replace(/\/[^/]+$/, '')  + '/js'
				}]
			};
    	</script>
	</head>

	<body style="height:100%;" id="mainBody">
		<div style="position:absolute;height:100%;width:100%">
				
			<div id="tooltipcontainer">
				<div class="tooltip" id="tip">
	  				<span class="tooltiptext" id="tiptext"> Tooltip text</span>
				</div>
			</div>
	
			<div id="bodyDisplayPort" class="bodyDisplayPortCollapse">
				<div style="position:absolute;width:100%;">
					<div class="titleContainer">
						<p class="titleText"><strong>Body</strong></p>
					</div>
					<input class="screenButton" id="bodyScreenButton" type="button" onclick="expandCollapse(this, 'bodyDisplayPort')" value="Expand"></input>
					<div  id="bodyGui">
					</div>
				</div>
				<div id="systemToggle">
					<input id="Cardiovascular" title="Cardiovascular system" class="w3-circle systemToggleButton systemToggleButtonOff" type="button" value="CV" style="background-color:#7f1e00;" onclick="systemButtonPress(this);">
					<br>
					<input id="Digestive" title="Digestive system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="D" style="background-color:#FFE4E1;" onclick="systemButtonPress(this);">
					<br>
					<input id="Endocrine" title="Endocrine system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="E" style="background-color:DARKORANGE;" onclick="systemButtonPress(this);">
					<br>
					<input id="Immunological" title="Immunological system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="I" style="background-color:REBECCAPURPLE;" onclick="systemButtonPress(this);">
					<br>
					<input id="Musculo-skeletal" title="Musculoskeletal system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="MSK" style="background-color:rgb(90%, 90%, 70%);" onclick="systemButtonPress(this);">
					<br>
					<input id="Brain & Central Nervous" title="Nervous system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="N" style="background-color:#FFDAB9;" onclick="systemButtonPress(this);">
					<br>
					<input id="Respiratory" title="Respiratory system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="R" style="background-color:#DB7093;" onclick="systemButtonPress(this);">
					<br>
					<input id="Male Reproductive" title="Reproductive system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="RM" style="background-color:#FA8072;" onclick="systemButtonPress(this);">
					<br>
					<input id="Female Reproductive" title="Female reproductive system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="RF" style="background-color:#FFC0CB;" onclick="systemButtonPress(this);">
					<br>
					<input id="Skin (integument)" title="Skin" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="S" style="background-color:rgb(90%, 70%, 50%);" onclick="systemButtonPress(this);">
					<br>
					<input id="Special sense organs" title="Special senses" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="SS" style="background-color:GOLDENROD;" onclick="systemButtonPress(this);">
					<br>
					<input id="Urinary" title="Urinary system" class="w3-circle systemToggleButton systemToggleButton systemToggleButtonOff" type="button" value="U" style="background-color:DARKOLIVEGREEN;" onclick="systemButtonPress(this);">
				</div>
				<div id="bodyDisplayArea" style="height:100%;">	
				</div>
			</div>		
		
			<div id="organsDisplayPort" class="organsDisplayPortCollapse">
				<div style="position:absolute;width:100%;">
					<div class="titleContainer">
						<p class="titleText" id="OrganTitle"><strong>Organ</strong></p>
					</div>
					<input class="screenButton" id="organsScreenButton" type="button" onclick="expandCollapse(this, 'organsDisplayPort')" value="Expand"</input>
					<div  id="organGui">
					</div>			
				</div>
				<div id="organsDisplayArea" style="height:100%;">
				</div>
			</div>
			
			<div id="tissueDisplayPort" class="tissueDisplayPortCollapse">
				<div style="position:absolute;width:100%;">
					<div class="titleContainer" style="bottom:2%;">
						<p class="titleText" id="TissueTitle"><strong>Tissue</strong></p>
					</div>
					<input class="screenButton" id="tissueScreenButton" type="button" onclick="expandCollapse(this, 'tissueDisplayPort')" value="Expand"</input>
					<div id="tissueGui">
					</div>
				</div>
				<div id="tissueDisplayArea" style="height:100%;">
				</div>
				<div id="cellButtonContainer" style="visibility:hidden;">
					<div id="cellButtonDivider" style="positon:relative;bottom:10%;">
						<div style="padding-left:10%;float:left;text-align: center;">
							<input class="w3-circle w3-gray w3-hover-gray" style="z-index:2;" id="cellButton1" type="button" onclick="openCellModelUI('Cardiomyocyte')" value="Cardiomyocyte"</input>
						</div>
						<div style="padding-right:10%;float:right"text-align: center;">
							<a target="_blank" href="https://models.physiomeproject.org/mechanical_constitutive_laws">Constitutive laws</a>
						</div>
					</div>
					<div id="cellButtonDivider" style="bottom:4%;">
						<div style="padding-left:10%;float:left;text-align: center;">
							<input class="w3-circle w3-gray w3-hover-gray" style="z-index:2;" id="cellButton2" type="button" onclick="openCellModelUI('Cardiac fibroblast')" value="Cardiac fibroblast"</input>
						</div>
					</div>
				</div>
			</div>
			
			<div id="cellDisplayPort" class="cellDisplayPortCollapse">
				<div style="width:100%;">
					<div class="titleContainer" style="bottom:5%;">
						<p class="titleText" id="CellTitle"><strong>Cell</strong></p>
					</div>
					<input class="screenButton" id="cellScreenButton" type="button" onclick="expandCollapse(this, 'cellDisplayPort')" value="Expand"</input>
					<div id="cellGui">
					</div>
					<div class="textContainer">
						<p style="text-align: center;">&nbsp;</p>
						<p style="text-align: center;">&nbsp;</p>
						<p style="text-align: center;">&nbsp;</p>
					</div>
				</div>
				<div id="imageContainer" style="text-align:center;bottom:4%;width:85%;left:7.5%; visibility: hidden;position: relative;">
					<a target="_blank" href = "https://models.physiomeproject.org/exposure/d5d6bff87af2bc1e94b6e8706227ba1a">
						<img align="middle" src="images/sample-heatmap.png" style="max-height:80%;max-width:100%;">
					</a>
				</div>
			</div>
			
			<div id="modelDisplayPort" class="modelDisplayPortCollapse">
				<div style="width:100%;">
					<div class="titleContainer">
						<p class="titleText" id="ModelTitle"><strong>Models</strong></p>
					</div>
					<input class="screenButton" id="modelScreenButton" type="button" onclick="expandSVGCollapse(this, 'modelDisplayPort')" value="Expand"</input>
					<div id="modelGui">
					</div>
					<div class="textContainer">
						<p style="text-align: center;">&nbsp;</p>
						<p style="text-align: center;">&nbsp;</p>
					</div>
				</div>
				<div id="modelsController" style="position:relative;text-align:center;visibility:hidden;">
						<input class="modelButton" type="button" onclick="runModel(this)" value="Run Simulation"></input>
						<p style="text-align: center;">&nbsp;</p>
						<div id="ZoomControl">
						<input id="svgZoomOut" title="Zoom Out" class="w3-circle w3-white w3-hover-white" style="width:30px;height:30px;" type="button" value="-" onclick="svgZoomOut();">
						<input  title="Reset" class="w3-circle w3-white w3-hover-white" style="height:30px;" type="button" value="Reset" onclick="resetZoom();">
						<input id="svgZoomIn" title="Zoom In" class="w3-circle w3-white w3-hover-white" style="width:30px;height:30px;" type="button" value="+"  onclick="svgZoomIn();">
						</div>
				</div>
				<p style="text-align: center;">&nbsp;</p>
				<div id="modelsContainer">
					<object class="svgContainer" id="testsvg" align="middle" type="image/svg+xml">SVGs not loaded yet.</object>
				<!--
					<p style="text-align: center;">&nbsp;</p>
					<input class="modelButton" type="button" onclick="svgElemenToggle('testsvg', 'cls-5')" value="Green"></input>
					<input class="modelButton" type="button" onclick="svgElemenToggle('testsvg', 'cls-6')" value="Orange"></input>
					<input class="modelButton" type="button" onclick="svgElemenToggle('testsvg', 'cls-7')" value="Pink"></input>					

					<div style="height:20%;border-top: 2px solid #000000;">
						<div style="height:100%;left:0%;width:50%;float:left;border-right: 2px solid #000000;border-bottom: 2px solid #000000;">
							<p style="text-align: center;">Electrophysiology</p>
							<a style="padding-bottom:1%;max-width:100%;max-height:100%;" target="_blank" href = "https://models.cellml.org/exposure/5230da0/jafri_rice_winslow_1998_b.cellml/view">
								<img align="middle" src="images/jafri_rice_winslow_1998.png" class="model">
							</a>
							<input class="modelButton" type="button" onclick="runModel(this)" value="Run Simulation"></input>
						</div>
						<div style="height:100%;left:50%;width:50%;float:left;">
							<p style="text-align: center;">&nbsp;</p>
							<p style="text-align: center;">Metabolism</p>
							<a style="max-width:100%;max-height:100%;" target="_blank" href = "https://models.cellml.org/exposure/1a1ce68/salem_saidel_stanley_cabrera_2002.cellml/view">
								<img align="middle" src="images/salem_2002.png" class="model">
							</a>
						</div>
					</div>
					<div style="height:20%;">
						<div style="height:100%;left:0%;width:50%;float:left;border-right: 2px solid #000000;border-bottom: 2px solid #000000;">
							<p style="text-align: center;">Signalling</p>
							<a style="width:100%;" target="_blank" href = "https://models.cellml.org/exposure/39fee05/cooling_hunter_crampin_2007.cellml/view">
								<img align="middle" src="images/cooling_2007.png" class="model">
							</a>
						</div>
					</div>
					-->	
				</div>
			</div>
		</div>

		<script src="js/three.min.js"></script>
		<script src="js/OBJLoader.js"></script>
		<script src="js/STLLoader.js"></script>
		<script src="js/zinc_threejs_control.js"></script>
		<script src="js/zinc_3js_renderer.js"></script>
		<script src="js/dat.gui.js"></script>
		<script src="js/dat.gui.removeFolder.js"></script>
		<link rel="stylesheet" type="text/css" href="styles/dat-gui-swec.css">
		<script src="js/modelsLoader.js"></script>
		<script src="js/bodyRenderer.js"></script>
		<script src="js/organsRenderer.js"></script>
		<script src="js/tissueRenderer.js"></script>
		<script src="js/cell_panel.js"></script>
		<script src="js/model_panel.js"></script>
		<script src="js/svgController.js"></script>
		<script>
			var bodyRenderer = undefined;
			var organsRenderer = undefined;
			var referenceRenderer = undefined;
			var currentHoverId = -1;
			var tooltipcontainerElement = document.getElementById('tooltipcontainer');
			var tipElement = document.getElementById('tip');
			var tiptextElement = document.getElementById('tiptext');
			
			var toggleSplitDisplay = function(displayStyle) {
				var portArrays = ["bodyDisplayPort", "organsDisplayPort", "tissueDisplayPort", "cellDisplayPort", "modelDisplayPort"];
				for (var i = 0; i < portArrays.length; i++) {
					var portElement = document.getElementById(portArrays[i]);
					portElement.className = portArrays[i] + "Collapse";
					portElement.style.display = displayStyle;
				}cellDisplayPort
			}
			
			var expandCollapse = function(source, portName) {
				if (source.value=="Expand") {
					source.value = "Collapse";
					toggleSplitDisplay("none");
					var portElement = document.getElementById(portName);
					portElement.className = "fullPortDisplay";
					portElement.style.display = "block";
				}
    			else { 
    				source.value = "Expand";
    				toggleSplitDisplay("block");
    			}
			
			}
			
			function setupRenderer(elementID) {
				var localContainer = document.createElement( 'div' );
				document.getElementById(elementID).appendChild( localContainer );
				localContainer.style.height = "100%"
				var localRenderer = new Zinc.Renderer(localContainer, window);
				Zinc.defaultMaterialColor = 0xFFFF9C
				localRenderer.initialiseVisualisation();
				localRenderer.playAnimation = false;	
				return localRenderer;
			}
			
			bodyRenderer = setupRenderer("bodyDisplayArea");
			initialiseBodyPanel();
			//loadBody();
			
			organsRenderer = setupRenderer("organsDisplayArea");
			initialiseOrgansVisualisation();
			
			bodyRenderer.animate();
			
			organsRenderer.addPreRenderCallbackFunction(updateTimeSliderCallback());
			organsRenderer.animate();
			
			volumeRenderInit();
			
			initialiseCellPanel();
			initialiseModelPanel();
			
			initialiseLoading();

		</script>

	</body>
</html>
